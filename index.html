<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<div class="container">
    <br>
    <h3>YKC Takip Formu</h3>
    <form id="form" onsubmit="return kontrol(this)">
        <div class="form-group">
            <label for="pwd">Tarih:</label>
            <input type="text" class="form-control" id="tarih" name="tarih" readonly>
            <br>
            <label for="pwd">Vardiya:</label>
            <input type="text" class="form-control" id="vardiya" name="vardiya" readonly>
            <br>
            <label for="hatlist">Hat:</label>

            <select class="form-control" id="hatlar" name="hatlist">
                <option>Hat Seçin</option>
                <option>9</option>
                <option>10</option>
                <option>2</option>
                <option>17</option>
                <option>UHF</option>
                <option>1</option>
                <option>8</option>
                <option>6</option>
                <option>4</option>
                <option>12</option>
                <option>20</option>
                <option>19</option>
                <option>18</option>
                <option>11</option>
                <option>15</option>
                <option>13</option>
                <option>14</option>
                <option>16</option>

            </select>
            <br>


            <label for="pwd">Kalıp:</label>
            <input type="text" class="form-control" id="kalip" placeholder="Kalıp" name="kalip">

        </div>
        <div class="row">
            <div class="col-lg-6 mb-4">
                <div class="form-check-inline">
                    <label class="form-check-label" for="check1">
                        <input type="checkbox" class="form-check-input" id="check1" name="devrede" value="E">
                        <input type="hidden" class="form-check-input" id="check1_" name="devrede" value="H">YKC
                        DEVREDE Mİ?
                    </label>
                </div>
                <br>
                <div class="form-check-inline">
                    <label class="form-check-label" for="check2">
                        <input type="checkbox" class="form-check-input" id="check2" name="boya" value="E">
                        <input type="hidden" class="form-check-input" id="check2_" name="boya" value="H">BOYA ATIYOR
                        MU?
                    </label>
                </div>
                <br>
                <div class="form-check-inline">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" id="check3" name="kalite" value="E">
                        <input type="hidden" class="form-check-input" id="check3_" name="kalite" value="">Kaliteye
                        Haber Verildi mi?
                    </label>
                </div>
                <br>
                <div class="form-check-inline">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" id="check4" name="klavuz" value="E">
                        <input type="hidden" class="form-check-input" id="check4_" name="klavuz" value="H">Klavuz
                        Uygun mu?
                    </label>
                </div>
                <br>
                <div class="form-check-inline">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" id="check5" name="ofuygun" value="E">
                        <input type="hidden" class="form-check-input" id="check5_" name="ofuygun" value="H">Ayarlar
                        Of'a uygun mu?
                    </label>
                </div>
                <br>
                <div class="form-check-inline">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" id="check6" name="etkin" value="E">
                        <input type="hidden" class="form-check-input" id="check6_" name="etkin" value="H">YKC etkin
                        çalışıyor mu?
                    </label>
                </div>
                <br>
                <br>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="form-group">
                    <label for="comment">Açıklamalar:</label>
                    <textarea name="aciklama" class="form-control" rows="5" id="comment"></textarea>
                    <input type="hidden" class="form-check-input" id="check7_" name="aksiyon" value="">
                </div>
            </div>

        </div>

        <select class="form-control" id="ekiplideri" name="elider">
            <option>EKİP LİDERİ</option>
            <option>ULVİ ÜSTÜN</option>
            <option>ERSİN BAŞ</option>
            <option>TOLGA AKTAŞ</option>
            <option>ENGİN ALTUNDAL</option>
            <option>MURAT CENGİZ</option>
            <option>ÖZKAN DURAN</option>
            <option>SERDAR DURMAZ</option>
            <option>YÜCEL TİRYAKİ</option>
            <option>REŞİT KARABULUT</option>
            <option>KERİM KIBRIS</option>
            <option>MURAT ERTÜRK</option>
            <option>HALİT MERTTÜRK</option>
            <option>HAYRULLAH KÜÇÜK</option>
            <option>BARIŞ ÖZTÜRK</option>
            <option>BERAT KAYA</option>
            <option>SEZGİN UYSAL</option>
            <option>ERDEM ONUR</option>
            <option>ERKAN ÖZTÜRK</option>
            <option>CEM YEŞİLYURT</option>
            <option>ERTUĞRUL YALÇIN</option>
            <option>SELÇUK KASABOĞLU</option>
            <option>SEDAT SEZGİN</option>
            <option>LEVENT KUŞÇU</option>
            <option>SERACETTİN ÖZTÜRKOĞLU</option>
            <option>İLKAY PERDAHÇIOĞLU</option>
            <option>LEVENT ÜRÜN</option>
            <option>MURAT HOŞBAŞ</option>
            <option>FATİH DEMİRCAN</option>
            <option>SUAT İPEK</option>
            <option>İLHAN AKPINAR</option>
            <option>MUSTAFA KARAGÜL</option>
            <option>FATİH TÜRKMEN</option>
            <option>MURAT KİBRİTÇİ</option>
            <option>TURGUT KAPLAN</option>
            <option>AYDOĞAN BOZKURT</option>
            <option>FİKRET KURT</option>
            <option>ÖZKAN ÇAĞLAR</option>
            <option>EJDER ÖZDEMİR</option>
            <option>GÖKHAN YILDIRIM</option>
            <option>KENAN AYGÜN</option>
            <option>YUSUF DUMAN</option>
            <option>SERKAN AKTEPE</option>
            <option>AHMET TOK</option>
            <option>SELÇUK SARI</option>
            <option>CEM ÖNAL</option>
            <option>MUHAMMED KÜÇÜK</option>
            <option>ERDİNÇ KAPLAN</option>
            <option>ENES BAYRAKTAR</option>
            <option>ERGÜN OZAN</option>
            <option>ÖZGÜR DEMİR</option>
            <option>ERHAN DİNÇ</option>
            <option>AYTAÇ TEMİZEL</option>
            <option></option>


        </select>

        <br>


        <select class="form-control" id="puan" name="puan">
            <option>Puan Verin:</option>
            <option>100</option>
            <option>90</option>
            <option>80</option>
            <option>60</option>
            <option>40</option>
            <option>20</option>
            <option>0</option>


        </select>
        <br>


        <select class="form-control" id="alansorumlusu" name="alansor">
            <option>ALAN SORUMLUSU</option>
            <option>AZİZ USTABAŞI</option>
            <option>VEDAT ORAN</option>
            <option>GÖKHAN YİĞİT</option>
            <option>ERSİN DEMİREL</option>
        </select>
        <br>

        <button type="submit" class="btn btn-primary">Kaydet</button>&nbsp;
        <button onclick="hepsiniAl()" type="button" class="btn btn-danger">Dışa Aktar</button>
    </form>
<br>
    <select onchange="tamamla(this)" class="form-control" id="tamamlama" name="tamamlama">
        <option>Otomatik doldur</option>
        <option>Smooth değerleri yüksek.</option>
        <option>A kamerası focus uygun değil.</option>
        <option>B kamerası focus uygun değil.</option>
        <option>C kamerası focus uygun değil.</option>
        <option>D kamerası focus uygun değil.</option>
        <option>Ayarlar ofa göre değil.</option>
        <option>Kamera ışıkları parlak.</option>
        <option>Boya atmıyor. Yana alınmış.</option>
        <option>Boya tıkanmış.</option>
        <option>Smooth değerleri düşürüldü.</option>
        <option>Kamera ışıkları kısıldı, smooth değerleri düşürüldü.</option>
        <option>Ekip liderine bilgi verildi.</option>
        <option>Profil yüzeyinden su geliyor.</option>
        <option>Üretime giriş. H.Uzun ayarladı.</option>
        <option>Üretime giriş. İ.Sevindik ayarladı.</option>
        <option>13</option>
        <option>14</option>
        <option>16</option>

    </select>
    <br>

</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.1/xlsx.full.min.js"></script>
<script>
function serializeToJson(serializer) {
    var _string = '{';
    for (var ix in serializer) {
        var row = serializer[ix];
        _string += '"' + row.name + '":"' + row.value + '",';
    }
    var end = _string.length - 1;
    _string = _string.substr(0, end);
    _string += '}';
    console.log('_string: ', _string);
    return JSON.parse(_string);
}

function ExportData(data) {
    filename = 'reports.xlsx';



    var ws = XLSX.utils.json_to_sheet(data);
    var wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "TEST");
    XLSX.writeFile(wb, filename);
}



function kontrol(form) {
    soru = confirm("Kaydedilecek, emin misiniz?");
    if (!soru) {
        return false;
    }
    if (alansorumlusu.value == 'ALAN SORUMLUSU' || kalip.value == '' || hatlar.value == 'Hat Seçin' || puan.value == 'Puan Verin:' || ekiplideri.value == 'EKİP LİDERİ') {
        alert("Zorunlu alanları doldurun!");
        return false;
    }

    inp_list = ["check1", "check2", "check3", "check4", "check5", "check6"];
    for (inp in inp_list) {

        if (document.getElementById(inp_list[inp]).checked) {
            document.getElementById(inp_list[inp] + '_').disabled = true;
        } else {
            document.getElementById(inp_list[inp] + '_').disabled = false;
        }

    }


    data_ = serializeToJson($(form).serializeArray());
    data_.puan = parseInt(data_.puan);
    alert(JSON.stringify(data_));
    hat = hatlar.value.toString();
    return setItem(hat, data_);
    //ExportData(data_);


}

function tarih_al() {
    var dateObj = new Date();
    var month = dateObj.getUTCMonth() + 1; //months from 1-12
    var day = dateObj.getUTCDate();
    var year = dateObj.getUTCFullYear().toString().substr(2, 2);

    newdate = day + "." + month + "." + year;
    return newdate;
}

function vardiya_al() {
    v = "";
    saat = new Date().getHours();
    console.log(saat);
    if (saat < 8) v = "V3";
    else if (saat < 16) v = "V1";
    else if (saat < 24) v = "V2";
    return v;

}

Storage.prototype.setObj = function(key, obj) {
    return this.setItem(key, JSON.stringify(obj))
}
Storage.prototype.getObj = function(key) {
    return JSON.parse(this.getItem(key))
}

function setItem(key, val) {


    localStorage.setObj(key, val);
    form.reset();
    tarih.value = tarih_al();
    vardiya.value = vardiya_al();
    return false;

}

function getItem(key) {
    return localStorage.getObj(key);

}

function test() {
    alert(JSON.stringify(getItem(hatlar.value.toString())))
}

function hepsiniAl() {
    soru = confirm("Eminseniz Excell dosyası indirilecek!");
    if (!soru) {
        return false;
    }
    hatlst = hatlar.getElementsByTagName("option");

    setlst = [];
    for (i in hatlst) {
        item = getItem(hatlst[i].value);
        if (item != null) {
            setlst.push(item);
        }
    }
    ExportData(setlst);
}

function tamamla(el) {
    comment.value += el.value;
}

function init() {
    tarih.value = tarih_al();
    vardiya.value = vardiya_al();
    global_data = [];
}

init();

</script>


</body>
</html>
