<html>
<head>
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<div class="container">
  <h3>YKC Takip Formu</h3>
  <form id="form" onsubmit="return kontrol(this)">
    <div class="form-group">
     <label for="pwd">Tarih:</label>
      <input type="text" class="form-control" id="tarih" name="tarih" disabled>
      <br>
      <label for="pwd">Vardiya:</label>
      <input type="text" class="form-control" id="vardiya" name="vardiya" disabled>
      <br>
      <label for="hatlist">Hat:</label>
      
      <select class="form-control" id="hatlar" name="hatlist">
        <option>9</option>
        <option>10</option>
        <option>2</option>
        <option>17</option>
        <option>UHF</option>
        <option>1</option>
        <option>8</option>
        <option>6</option>
        <option>4</option>
        <option>12</option>
        <option>20</option>
        <option>19</option>
        <option>18</option>
        <option>11</option>
        <option>15</option>
        <option>13</option>
        <option>14</option>
        <option>16</option>
        
      </select>
      <br>
    
      <label for="pwd">Kalıp:</label>
      <input type="text" class="form-control" id="kalip" placeholder="Kalıp" name="kalip">
      
    </div>
    <div class="row">
    <div class="col-lg-6 mb-4">
	    <div class="form-check-inline">
	      <label class="form-check-label" for="check1">
		<input type="checkbox" class="form-check-input" id="check1" name="devrede" value="ok">YKC DEVREDE Mİ?
	      </label>
	    </div>
	    <br>
	    <div class="form-check-inline">
	      <label class="form-check-label" for="check2">
		<input type="checkbox" class="form-check-input" id="check2" name="boya" value="ok">BOYA ATIYOR MU?
	      </label>
	    </div>
	    <br>
	    <div class="form-check-inline">
	      <label class="form-check-label">
		<input type="checkbox" class="form-check-input" id="check3" name="kalite" value="ok">Kaliteye Haber Verildi mi?
	      </label>
	    </div>
	    <br>
	    <div class="form-check-inline">
	      <label class="form-check-label">
		<input type="checkbox" class="form-check-input" id="check4" name="klavuz" value="ok">Klavuz Uygun mu?
	      </label>
	    </div>
	    <br>
	    <div class="form-check-inline">
	      <label class="form-check-label">
		<input type="checkbox" class="form-check-input" id="check5" name="ofuygun" value="ok">Ayarlar Of'a uygun mu?
	      </label>
	    </div>
	    <br>
	    <div class="form-check-inline">
	      <label class="form-check-label">
		<input type="checkbox" class="form-check-input" id="check6" name="etkin" value="ok">YKC etkin çalışıyor mu?
	      </label>
	    </div>
	    <br>
	    <br>
	    </div>
	    <div class="col-lg-6 mb-4">
	    <div class="form-group">
  <label for="comment">Açıklamalar:</label>
  <textarea name = "aciklama" class="form-control" rows="5" id="comment"></textarea>
</div>
	    </div>
	    
    </div>
    
    <button type="submit" class="btn btn-primary">Kaydet</button>
  </form>
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.1/xlsx.full.min.js"></script> 
<script>

function serializeToJson(serializer){
    var _string = '{';
    for(var ix in serializer)
    {
        var row = serializer[ix];
        _string += '"' + row.name + '":"' + row.value + '",';
    }
    var end =_string.length - 1;
    _string = _string.substr(0, end);
    _string += '}';
    console.log('_string: ', _string);
    return JSON.parse(_string);
}
    function ExportData()
    {
            filename='reports.xlsx';
            data = serializeToJson($(form).serializeArray());
            data.kalite = "NOK";
            data.vardiya = vardiya_al();
            data.tarih = tarih_al();
       data=[
       
       	data
       
       ];
        var ws = XLSX.utils.json_to_sheet(data);
        var wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "TEST");
        XLSX.writeFile(wb,filename);
     }
     
     
     
     function kontrol(form){
      //alert("test aşaması");
       data_ = serializeToJson($(form).serializeArray());
       alert(JSON.stringify(data_));
       ExportData();
       return false;
     
     }
     function tarih_al(){
     var dateObj = new Date();
var month = dateObj.getUTCMonth() + 1; //months from 1-12
var day = dateObj.getUTCDate();
var year = dateObj.getUTCFullYear();

newdate = day + "." + month + "." + year;
return newdate;
     }
     function vardiya_al(){
     v= "";
     	saat = new Date().getHours();
     	console.log(saat);
     	if (saat < 8) v = 3;
     	else if (saat < 16) v = 1;
     	else if (saat < 24 ) v = 2;
     	return v;
     
     }
     tarih.value = tarih_al();
     vardiya.value  = vardiya_al();
</script>



</body>
</html>
